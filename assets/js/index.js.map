{"version":3,"sources":["index.js"],"names":["data","carts","cartsTotal","productsList","document","querySelector","cartsList","cartsPrice","deleteAll","filter","init","getProductList","getCartList","axios","get","api_path","then","response","products","renderProductList","error","console","log","combineProductListItem","item","images","description","id","title","origin_price","price","str","forEach","innerHTML","addEventListener","e","target","value","category","preventDefault","clickId","getAttribute","productQuantity","product","quantity","post","finalTotal","renderShoppingCart","subtotalPrice","length","cartId","deleteCartItem","submit","orderName","orderTel","orderEmail","orderAddress","orderTrade","alert","createOrder","event","options"],"mappings":"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","sourcesContent":["let data = [];\nlet carts = [];\nlet cartsTotal\n\nconst productsList = document.querySelector(\".js-productsList\");\nconst cartsList = document.querySelector(\".js-cartsList\");\nconst cartsPrice = document.querySelector(\".js-cartsPrice\");\nconst deleteAll = document.querySelector('.js-deleteAll');\nconst filter = document.querySelector('.filter');\n\n// init 產品列表\n// 選擇後重新渲染\n// init 購物車\n// 選擇後重新渲染\n\n// 產品列表\n\nfunction init() {\n  getProductList();\n  getCartList();\n}\n\ninit();\n\n// ------ 產品列表 ------\nfunction getProductList() {\n  axios.get(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${api_path}/products`).\n    then(function (response) {\n      data = response.data.products;\n      renderProductList();\n    })\n    .catch(function (error) {\n      console.log(error.response.data);\n    })\n}\n\nfunction combineProductListItem(item) {\n  return `\n          <li class=\"newArrival relative mb-7\">\n            <img src=\"${item.images}\" alt=\"${item.description}\" class=\"object-cover h-80\">\n            <input type=\"button\" value=\"加入購物車\" data-id=\"${item.id}\"\n              class=\"text-xl text-white  bg-black hover:bg-primaryColor-dark2 cursor-pointer py-3 w-full\" data-addCart=\"js-addCart\">\n            <p class=\"text-xl\">${item.title}</p>\n            <p class=\"text-xl line-through\">NT$${item.origin_price}</p>\n            <h3 class=\"text-3xl\">NT$${item.price}</h3>\n          </li>\n        `\n}\n\nfunction renderProductList() {\n  let str = \"\";\n  data.forEach(function (item) {\n    str += combineProductListItem(item);\n  });\n\n  productsList.innerHTML = str;\n};\n\n//篩選器\nfilter.addEventListener(\"change\", function (e) {\n\n  let str = \"\";\n\n  data.forEach(function (item) {\n    if (e.target.value === item.category) {\n      str += combineProductListItem(item);\n\n    } else if (e.target.value === \"all\") {\n      str += combineProductListItem(item);\n    }\n  });\n\n  productsList.innerHTML = str;\n})\n\n// 加入購物車\nproductsList.addEventListener('click', function (e) {\n  e.preventDefault();\n\n\n  // 點擊的商品id\n  let clickId = e.target.getAttribute(\"data-id\");\n\n  // 判斷購物車是否含有該商品\n  // const inCarts = arrayCartId.includes(clickId);\n\n\n\n  if (e.target.getAttribute(\"data-addCart\") !== \"js-addCart\") {\n    return;\n  } else {\n    console.log(clickId)\n\n    let productQuantity = 1;\n\n    carts.forEach(function (item) {\n      if (item.product.id === clickId) {\n        productQuantity = item.quantity += 1;\n      };\n    });\n    console.log(productQuantity);\n\n    axios.post(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${api_path}/carts`, {\n      \"data\": {\n        \"productId\": clickId,\n        \"quantity\": productQuantity\n      }\n    }).\n      then(function (response) {\n        console.log(response.data);\n        getCartList();\n      })\n      .catch(function (error) {\n        console.log(error.response.data)\n      })\n  }\n});\n\n\n// ------ 購物車 ------\nfunction getCartList() {\n  axios.get(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${api_path}/carts`).\n    then(function (response) {\n      carts = response.data.carts;\n      cartsTotal = response.data.finalTotal;\n      renderShoppingCart();\n    })\n    .catch(function (error) {\n      console.log(error.response.data);\n    })\n}\n\nfunction renderShoppingCart() {\n  let str = \"\";\n  carts.forEach(function (item) {\n    let subtotalPrice = item.product.price * item.quantity;\n\n    str += `\n      <tr class=\"border-b\">\n        <td class=\"flex\">\n          <img src=\"${item.product.images}\" alt=\"${item.product.description}\" class=\"h-40 py-5\">\n          <div class=\"flex items-center ml-4\">\n            <p class=\"text-xl\">${item.product.title}</p>\n          </div>\n        </td>\n        <td>NT$${item.product.price}</td>\n        <td>${item.quantity}</td>\n        <td>NT$${subtotalPrice}</td>\n        <td class=\"text-center\">\n          <i class=\"fas fa-times fa-2x cursor-pointer\" data-delProduct=\"delProduct\" data-cartId=\"${item.id}\"></i>\n        </td>\n      </tr>\n    `;\n  })\n\n  if (str.length == 0) {\n    cartsList.innerHTML = `\n      <tr>\n        <td colspan=\"5\" class=\"h-36 text-gray-300 text-3xl font-light text-center\">目前購物車無商品</td>\n      </tr>`\n  } else {\n    cartsList.innerHTML = str;\n  }\n\n  cartsPrice.innerHTML = `NT$${cartsTotal}`;\n}\n\n// 刪除購物車內全部商品\ndeleteAll.addEventListener('click', function () {\n  axios.delete(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${api_path}/carts`).\n    then(function (response) {\n      console.log(response.data);\n      init();\n    })\n});\n\n// 刪除購物車內指定商品\ncartsList.addEventListener(\"click\", function (e) {\n  const cartId = e.target.getAttribute(\"data-cartId\");\n  if (e.target.getAttribute(\"data-delProduct\") !== \"delProduct\") {\n    console.log(\"點擊錯誤\")\n  } else {\n    console.log(cartId);\n    deleteCartItem(cartId);\n  }\n\n})\n\nfunction deleteCartItem(cartId) {\n  axios.delete(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${api_path}/carts/${cartId}`).\n    then(function (response) {\n      console.log(response.data);\n      init();\n    })\n}\n\n\n\n// ------ 預定表單 ------\n\nconst submit = document.querySelector(\".js-submit\");\n\n\nconst orderName = document.querySelector(\".js-name\");\nconst orderTel = document.querySelector(\".js-tel\");\nconst orderEmail = document.querySelector(\".js-email\");\nconst orderAddress = document.querySelector(\".js-address\");\nconst orderTrade = document.querySelector(\".js-trade\");\n\n\n// 送出購買訂單\nsubmit.addEventListener(\"click\", function (e) {\n  if (orderName.value == \"\") {\n    alert(\"請輸入姓名\");\n  } else if (orderTel.value == \"\") {\n    alert(\"請輸入電話\");\n  } else if (orderEmail.value == \"\") {\n    alert(\"請輸入 Email\");\n  } else if (orderAddress.value == \"\") {\n    alert(\"請輸入地址\");\n  } else if (orderTrade.value == \"\") {\n    alert(\"請選擇交易方式\");\n  } else {\n    createOrder();\n  }\n  event.preventDefault();\n})\n\nfunction createOrder() {\n  axios.post(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${api_path}/orders`,\n    {\n      \"data\": {\n        \"user\": {\n          \"name\": orderName.value,\n          \"tel\": orderTel.value,\n          \"email\": orderEmail.value,\n          \"address\": orderAddress.value,\n          \"payment\": orderTrade.value\n        }\n      }\n    }\n  ).\n    then(function (response) {\n      console.log(response.data);\n\n      orderName.value = \"\";\n      orderTel.value = \"\";\n      orderEmail.value = \"\";\n      orderAddress.value = \"\";\n      orderTrade.value = orderTrade.options[0].value;\n\n      init();\n    })\n    .catch(function (error) {\n      console.log(error.response.data);\n    })\n}\n\n\n// validate 沒搞定\n\n// const inputs = document.querySelectorAll(\".js-input\");\n// const orderForm = document.querySelectorAll(\".js-orderForm\");\n// const constraints = {\n//   \"name\": {\n//     presence: {\n//       message: \"必填欄位\"\n//     }\n//   },\n//   \"tel\": {\n//     presence: {\n//       message: \"必填欄位\"\n//     },\n//     length: {\n//       minimum: 8,\n//       message: \"需超過 8 碼\"\n//     }\n//   },\n//   \"email\": {\n//     presence: {\n//       message: \"必填欄位\"\n//     },\n//     email: {\n//       message: \"格式錯誤\"\n//     }\n//   },\n//   \"address\": {\n//     presence: {\n//       message: \"必填欄位\"\n//     }\n//   },\n//   \"trade\": {\n//     presence: {\n//       message: \"必填欄位\"\n//     }\n//   },\n// };\n\n\n\n// inputs.forEach((item) => {\n//   item.addEventListener(\"change\", function () {\n\n//     // 偽元素內容：重置清空\n//     let alertText = item.parentNode.getAttribute(\"data-text\");\n\n//     item.parentNode.setAttribute(\"data-text\", '');\n//     // console.log(item.parentNode.getAttribute(\"data-text\"));\n\n//     // validate 變數\n//     let errors = validate(orderForm, constraints) || '';\n//     console.log(errors)\n\n//     if (errors) {\n//       Object.keys(errors).forEach(function (keys) {\n//         // console.log(document.querySelector(`[data-message=${keys}]`))\n\n//         console.log(keys)\n//         // document.querySelector(`[data-text=\"${keys}\"]`).setAttribute(\"data-text\", `${errors[keys]}`);\n//       })\n//     }\n//   });\n// });\n"],"file":"index.js"}