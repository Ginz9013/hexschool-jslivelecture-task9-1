{"version":3,"sources":["backstage-items.js"],"names":["api_path","token","orderInfo","document","querySelector","deleteAll","orderList","orderListInit","getOrderList","axios","get","headers","then","response","data","orders","renderOrderList","renderOrderChart","error","console","log","orderListTitle","objProducts","forEach","item","products","product","title","undefined","price","arrProducts","Object","keys","arrProductsPrice","push","objColors","arrayColors","index","chart","c3","generate","columns","type","onclick","d","i","colors","str","productStr","itemProduct","content","quantity","orderStatus","paid","createdAt","user","name","tel","address","email","id","innerHTML","addEventListener","deleteAllOrder","e","orderId","target","getAttribute","deleteOrderItem","orderPaid","updateStatus","put"],"mappings":"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","sourcesContent":["const api_path = \"ginz9013\";\nconst token = \"gtVaknIHOtelzoQpEvYjNzBMCjq1\";\n\nconst orderInfo = document.querySelector(\".js-orderInfo\")\nconst deleteAll = document.querySelector(\".js-deleteAll\")\n\nlet orderList = [];\n\n\n\n\n\n\n// setTimeout(function () {\n//   chart.load({\n//     columns: [\n//       [\"setosa\", 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.2, 0.1, 0.1, 0.2, 0.4, 0.4, 0.3, 0.3, 0.3, 0.2, 0.4, 0.2, 0.5, 0.2, 0.2, 0.4, 0.2, 0.2, 0.2, 0.2, 0.4, 0.1, 0.2, 0.2, 0.2, 0.2, 0.1, 0.2, 0.2, 0.3, 0.3, 0.2, 0.6, 0.4, 0.3, 0.2, 0.2, 0.2, 0.2],\n//       [\"versicolor\", 1.4, 1.5, 1.5, 1.3, 1.5, 1.3, 1.6, 1.0, 1.3, 1.4, 1.0, 1.5, 1.0, 1.4, 1.3, 1.4, 1.5, 1.0, 1.5, 1.1, 1.8, 1.3, 1.5, 1.2, 1.3, 1.4, 1.4, 1.7, 1.5, 1.0, 1.1, 1.0, 1.2, 1.6, 1.5, 1.6, 1.5, 1.3, 1.3, 1.3, 1.2, 1.4, 1.2, 1.0, 1.3, 1.2, 1.3, 1.3, 1.1, 1.3],\n//       [\"virginica\", 2.5, 1.9, 2.1, 1.8, 2.2, 2.1, 1.7, 1.8, 1.8, 2.5, 2.0, 1.9, 2.1, 2.0, 2.4, 2.3, 1.8, 2.2, 2.3, 1.5, 2.3, 2.0, 2.0, 1.8, 2.1, 1.8, 1.8, 1.8, 2.1, 1.6, 1.9, 2.0, 2.2, 1.5, 1.4, 2.3, 2.4, 1.8, 1.8, 2.1, 2.4, 2.3, 1.9, 2.3, 2.5, 2.3, 1.9, 2.0, 2.3, 1.8],\n//     ]\n//   });\n// }, 1500);\n\n// setTimeout(function () {\n//   chart.unload({\n//     ids: 'data1'\n//   });\n//   chart.unload({\n//     ids: 'data2'\n//   });\n// }, 2500);\n\nfunction orderListInit() {\n  getOrderList();\n};\n\norderListInit();\n\n\n// 取得訂單列表\nfunction getOrderList() {\n  axios.get(`https://livejs-api.hexschool.io/api/livejs/v1/admin/${api_path}/orders`,\n    {\n      headers: {\n        'Authorization': token\n      }\n    })\n    .then(function (response) {\n      orderList = response.data.orders;\n      // console.log(orderList);\n      renderOrderList();\n      renderOrderChart()\n    })\n    .catch(function (error) {\n      console.log(error.response.data);\n    })\n}\n\n// 渲染上方圓餅圖 c3.js\nfunction renderOrderChart() {\n  let orderListTitle = [];\n\n  let objProducts = {};\n\n  // 篩選資料\n  orderList.forEach(function (item) {\n    item.products.forEach(function (product) {\n      if (objProducts[product.title] == undefined) {\n        objProducts[product.title] = product.price;\n      } else {\n        objProducts[product.title] += product.price;\n      }\n    })\n  })\n\n  // 處理資料\n  let arrProducts = Object.keys(objProducts);\n\n  arrProducts.forEach(function (item) {\n    let arrProductsPrice = [];\n    arrProductsPrice.push(item);\n    arrProductsPrice.push(objProducts[item]);\n\n    orderListTitle.push(arrProductsPrice);\n  })\n\n\n  // 商品與顏色物件\n  let objColors = {};\n  let arrayColors = [\n    \"#6A33F8\",\n    \"#DACBFF\",\n    \"#5434A7\",\n    \"#9D7FEA\",\n    \"#301E5F\",\n    \"#CED4DA\",\n    \"000000\",\n    \"#808080\"\n  ];\n\n  arrProducts.forEach(function (item, index) {\n    if (objColors[item] == undefined) {\n      objColors[item] = arrayColors[index]\n    } else {\n      return;\n    }\n  });\n\n\n  // 套入C3.js\n  let chart = c3.generate({\n    data: {\n      // iris data from R\n      columns: orderListTitle,\n      type: 'pie',\n      onclick: function (d, i) { console.log(\"onclick\", d, i); },\n      colors: objColors\n    }\n  });\n}\n\n\n// 渲染下方訂單列表\nfunction renderOrderList() {\n\n  let str = \"\";\n\n  orderList.forEach(function (item) {\n\n    // 遍歷訂購產品\n    let productStr = \"\";\n\n    item.products.forEach(function (itemProduct) {\n      let content = `\n        <li>${itemProduct.title}(${itemProduct.quantity})</li>\n        `;\n\n      productStr += content;\n    })\n    // 遍歷訂購產品\n\n\n\n    // 判斷訂單狀態\n    let orderStatus = \"\";\n    if (item.paid === false) {\n      orderStatus = \"未處理\";\n    } else if (item.paid === true) {\n      orderStatus = \"已處理\";\n    }\n    // 判斷訂單狀態\n\n\n    let content = `\n      <div class=\"col-span-3 border flex justify-center items-center\">\n        <p>${item.createdAt}</p>\n      </div>\n      <div class=\"col-span-3 border flex flex-col justify-center items-start pl-3 py-2\">\n        <p>${item.user.name}</p>\n        <p>${item.user.tel}</p>\n      </div>\n      <div class=\"col-span-5 border flex items-center px-3\">\n        <p>${item.user.address}</p>\n      </div>\n      <div class=\"col-span-5 border flex justify-center items-center\">\n        <p>${item.user.email}</p>\n      </div>\n      <ul class=\"col-span-4 border text-center py-2\">\n          ${productStr}\n      </ul>\n      <div class=\"col-span-3 border flex justify-center items-center\">\n        <p>2021/03/08</p>\n      </div>\n      <div class=\"col-span-2 border flex justify-center items-center\">\n        <a class=\"text-blue-500 underline leading-7 cursor-pointer\" data-orderStatus=\"orderStatus\" data-orderPaid=\"${item.paid}\" data-orderId=\"${item.id}\">${orderStatus}</a>\n      </div>\n      <div class=\"col-span-2 border flex justify-center items-center\">\n        <input type=\"button\" class=\"bg-gray-100 rounded-sm px-3 py-1 cursor-pointer hover:bg-red-600 hover:text-white\"\n          value=\"刪除\" data-deleteOrder=\"deleteOrder\" data-orderId=\"${item.id}\">\n      </div>\n    `\n\n    str += content;\n  });\n\n  orderInfo.innerHTML = str;\n}\n\n// 清除全部訂單\ndeleteAll.addEventListener(\"click\", function () {\n  deleteAllOrder();\n});\n\nfunction deleteAllOrder() {\n  axios.delete(`https://livejs-api.hexschool.io/api/livejs/v1/admin/${api_path}/orders`,\n    {\n      headers: {\n        'Authorization': token\n      }\n    })\n    .then(function (response) {\n      console.log(response.data);\n      orderListInit();\n    })\n    .catch(function (error) {\n      console.log(error.response.data);\n    })\n}\n\n\n// 刪除特定訂單\norderInfo.addEventListener(\"click\", function (e) {\n  const orderId = e.target.getAttribute(\"data-orderId\");\n  if (e.target.getAttribute(\"data-deleteOrder\") !== \"deleteOrder\") {\n    // console.log(\"點擊錯誤\");\n  } else {\n    console.log(\"點擊正確\");\n    console.log(orderId);\n    deleteOrderItem(orderId)\n  }\n})\n\nfunction deleteOrderItem(orderId) {\n  axios.delete(`https://livejs-api.hexschool.io/api/livejs/v1/admin/${api_path}/orders/${orderId}`,\n    {\n      headers: {\n        'Authorization': token\n      }\n    })\n    .then(function (response) {\n      console.log(response.data);\n      orderListInit();\n    })\n}\n\n// 更改訂單狀態\norderInfo.addEventListener(\"click\", function (e) {\n  const orderStatus = e.target.getAttribute(\"data-orderStatus\");\n  const orderPaid = e.target.getAttribute(\"data-orderPaid\");\n  const orderId = e.target.getAttribute(\"data-orderId\");\n\n  if (orderStatus !== \"orderStatus\") {\n    console.log(\"點擊錯誤\");\n  } else {\n    console.log(\"點擊正確\");\n    console.log(orderPaid);\n    console.log(orderId);\n\n    let updateStatus;\n\n    if (orderPaid == \"false\") {\n      updateStatus = true;\n    } else if (orderPaid == \"true\") {\n      updateStatus = false;\n    }\n\n    console.log(updateStatus);\n\n    axios.put(`https://livejs-api.hexschool.io/api/livejs/v1/admin/${api_path}/orders`,\n      {\n        \"data\": {\n          \"id\": orderId,\n          \"paid\": updateStatus\n        }\n      },\n      {\n        headers: {\n          'Authorization': token\n        }\n      })\n      .then(function (response) {\n        console.log(response.data);\n        orderListInit();\n      })\n\n  }\n})\n"],"file":"backstage-items.js"}